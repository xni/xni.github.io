<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Быстрый старт. Размещение интерактивной карты на странице</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="http://api-maps.yandex.ru/2.1/?lang=ru_RU" type="text/javascript"></script>
    <script src="/track.js" type="text/javascript"></script>
    <script type="text/javascript">
        ymaps.ready(init);
        var myMap, 
            myPlacemark;

        var point_index = 2200;
        var min_time = track[point_index][0];

        function next(){
            myMap.geoObjects.remove(myPlacemark);
            var current_time = track[point_index][0];
            point_index += 1;
            var next_point_time = track[point_index][0];
            myPlacemark = new ymaps.Placemark([track[point_index][1][0], track[point_index][1][1]], {
                hintContent: 'Москва!',
                balloonContent: 'Столица России'
            });
            myMap.geoObjects.add(myPlacemark);
            var interval = next_point_time - current_time;
            if (interval < 0)
                interval = 0;
            interval *= 100;
            var shot = document.getElementById('shot');
            while (shot.firstChild)
                shot.removeChild(shot.firstChild);
            shot.appendChild(document.createTextNode(point_index.toString()));
            if (point_index < 4000)
                setTimeout(next, interval);
        }

        function init(){ 
            myMap = new ymaps.Map("map", {
                center: [55.75896, 37.419476],
                zoom: 17
            }); 
            
            myPlacemark = new ymaps.Placemark([track[point_index][1][0], track[point_index][1][1]], {
                hintContent: 'Москва!',
                balloonContent: 'Столица России'
            });
            
            myMap.geoObjects.add(myPlacemark);
            next();
        }
    </script>
</head>

<body>
    <div id="map" style="width: 600px; height: 400px"></div>
    <div id="shot">2</div>
</body>

</html>