<!DOCTYPE html>
<html itemscope="" itemtype="https://schema.org/WebPage" lang="en"><head>
<meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bazel</title>

    <script src="Bazel_files/analytics.js" async=""></script><script>
      var current_url = window.location.href;
      var bad_url = new RegExp("^https?://google.github.io/bazel/");
      if (bad_url.test(current_url)) {
        window.location.replace(current_url.replace(bad_url, "http://bazel.io/"));
      }
    </script>

    <link rel="canonical" href="http://bazel.io/docs/getting-started.html">

    <!-- Webfont -->
    <link href="Bazel_files/css.css" rel="stylesheet">

    <link rel="shortcut icon" type="image/png" href="http://bazel.io/images/favicon.ico">

    <!-- Bootstrap -->
    <link href="Bazel_files/bootstrap.css" rel="stylesheet">
    <link href="Bazel_files/font-awesome.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Less custom stylesheet -->
    <link rel="stylesheet" type="text/css" href="Bazel_files/style.css">
    <link rel="stylesheet" type="text/css" href="Bazel_files/syntax.css">

    <!-- metadata -->
    <meta name="og:title" content="Bazel">
    <meta name="og:image" content="/images/bazel-og-image.png">
    <meta name="og:description" content="Correct, reproducible, fast builds for everyone">
  </head>


  <body>
        <nav id="common-nav" class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="http://bazel.io/">
            <img src="Bazel_files/bazel-navbar.png" height="30px">
          </a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
          <form class="navbar-form navbar-right" action="/search.html" id="cse-search-box">
            <div class="form-group">
              <input name="cx" value="012346921571893344015:xv_nfgpzbu4" type="hidden">
              <input name="cof" value="FORID:10" type="hidden">
              <input name="ie" value="UTF-8" type="hidden">
              <input name="q" class="form-control input-sm" placeholder="Search" type="search">
            </div>
          </form>
          <ul class="nav navbar-nav navbar-right">
            <li class="active">
              <a href="http://bazel.io/docs/install.html">Docs</a>
            </li>
            <li>
              <a href="http://bazel.io/contributing.html">Community</a>
            </li>
            <li>
              <a href="http://bazel.io/faq.html">FAQ</a></li>
            <li>
              <a href="http://bazel.io/blog">Blog</a>
            </li>
            <li><a href="https://github.com/google/bazel">GitHub</a></li>
            <li><a href="https://twitter.com/bazelbuild" class="nav-icon"><i class="fa fa-twitter"></i></a></li>
            <li><a href="https://groups.google.com/forum/#%21forum/bazel-discuss" class="nav-icon"><i class="fa fa-comments"></i></a></li>
          </ul>
        </div><!-- /.navbar-collapse -->
      </div><!-- /.container-fluid -->
    </nav>



    <div class="page-title-bar">
      <div class="container">
        <h1>Documentation</h1>
      </div>
    </div>

    <div class="container vpad">
      <div class="row">
        <div class="col-lg-2 col-md-3 col-sm-3">
          <nav class="sidebar">
            <ul class="sidebar-nav">
              <li><a href="http://bazel.io/docs/install.html">Installing</a></li>
              <li><a href="http://bazel.io/docs/getting-started.html">Getting Started</a></li>
              <li>
                <p class="sidebar-nav-heading">Using Bazel</p>
                <ul class="sidebar-nav">
                  <li><a href="http://bazel.io/docs/build-ref.html">Concepts</a></li>
                  <li><a href="http://bazel.io/docs/bazel-user-manual.html">User Manual</a></li>
                  <li><a href="http://bazel.io/docs/build-encyclopedia.html">Build Encyclopedia</a></li>
                  <li><a href="http://bazel.io/docs/test-encyclopedia.html">Test Encyclopedia</a></li>
                  <li><a href="http://bazel.io/docs/query.html">Query Language</a></li>
                  <li><a href="http://bazel.io/docs/cpp.html">C++ Basics</a></li>
                </ul>
              </li>
              <li>
                <p class="sidebar-nav-heading">Skylark</p>
                <ul class="sidebar-nav">
                  <li><a href="http://bazel.io/docs/skylark/index.html">Home</a></li>
                  <li><a href="http://bazel.io/docs/skylark/concepts.html">Concepts</a></li>
                  <li><a href="http://bazel.io/docs/skylark/rules.html">Rules</a></li>
                  <li><a href="http://bazel.io/docs/skylark/macros.html">Macros</a></li>
                  <li><a href="http://bazel.io/docs/skylark/library.html">Library</a></li>
                  <li><a href="http://bazel.io/docs/skylark/cookbook.html">Cookbook</a></li>
                </ul>
              </li>
              <li><a href="http://bazel.io/docs/skyframe.html">Skyframe</a></li>
            </ul>
          </nav>
        </div>
        <div class="col-lg-10 col-md-9 col-sm-9">
          <h1>Getting Started with Bazel</h1>

<h2>Setup</h2>

<p>Clone the Bazel <a href="https://github.com/google/bazel">Github repo</a> and run the
provided compile script. Make sure that you are running Bazel on a supported
platform and that you have installed other required software as described in the
<a href="http://bazel.io/docs/install.html">installation guide</a>.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>git clone https://github.com/google/bazel.git
<span class="nv">$ </span><span class="nb">cd </span>bazel
<span class="nv">$ </span>./compile.sh</code></pre></div>

<p><code>./compile.sh</code> creates the <code>bazel</code> executable in <code>output/bazel</code>.</p>

<p><em><strong>Note:</strong> Bazel may support a binary installation at a later time.</em></p>

<h2>Using a workspace</h2>

<p>A <em>workspace</em> is a directory on your filesystem that contains source code for
the software you want to build, as well symbolic links to directories that
contain the build outputs (for example, <code>bazel-bin</code> and <code>bazel-out</code>). The
location of the workspace directory is not significant, but it must contain an
empty file called <code>WORKSPACE</code> in the top-level directory. This file marks the
directory as the workspace root.</p>

<p>One workspace can be shared among multiple projects if desired.  To get
started, we'll focus on a simple example with one project.</p>

<p>Suppose that you have an existing project in a directory, say,
<code>~/gitroot/my-project/</code>. Create an empty file at
<code>~/gitroot/my-project/WORKSPACE</code> to show Bazel where your project's root is.</p>

<h2>Sanity Check: Building an Example</h2>

<p>To make sure everything is set up correctly in your build root, build one of the
examples from the <code>examples/</code> directory.</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="nb">cd</span> ~/gitroot/my-project
<span class="nv">$ </span>bazel fetch //...
<span class="nv">$ </span>bazel build examples/java-native/src/main/java/com/example/myproject:hello-world
Extracting Bazel installation...
...........
INFO: Found <span class="m">1</span> target...
Target //examples/java-native/src/main/java/com/example/myproject:hello-world up-to-date:
  bazel-bin/examples/java-native/src/main/java/com/example/myproject/hello-world.jar
  bazel-bin/examples/java-native/src/main/java/com/example/myproject/hello-world
INFO: Elapsed <span class="nb">time</span>: 3.040s, Critical Path: 1.14s
<span class="nv">$ </span>bazel-bin/examples/java-native/src/main/java/com/example/myproject/hello-world
Hello world</code></pre></div>

<p>Bazel puts binaries it has built under <code>bazel-bin/</code>.  Note that you can
always look at the <code>build</code> command's output to find output file paths.</p>

<h2>Creating Your Own Build File</h2>

<p>Now you can create your own BUILD file and start adding build rules. This
example assumes that <code>my-project/</code> is a Java project.  See the
<a href="http://bazel.io/docs/build-encyclopedia.html">build encyclopedia</a>
for advice on adding build rules for other languages.</p>

<p>Note that when we ran "bazel build" above, the third argument started with a
filesystem path ("examples/java"), followed by a colon. When you run
<code>bazel build examples/java-native/src/main/java/com/example/myproject:hello-world</code>,
Bazel will look for a special file named BUILD in the
<code>examples/java-native/src/main/java/com/example/myproject/</code> subdirectory. This
BUILD file defines rules about how Bazel should build things in this
subdirectory.</p>

<p>Thus, to add build rules to my-project, create a file named <code>BUILD</code> in the
<code>my-project/</code> directory.  Add the following lines to this BUILD file:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># ~/gitroot/base_workspace/my-project/BUILD</span>
<span class="n">java_binary</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"my-runner"</span><span class="p">,</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="n">glob</span><span class="p">([</span><span class="s">"**/*.java"</span><span class="p">]),</span>
    <span class="n">main_class</span> <span class="o">=</span> <span class="s">"com.example.ProjectRunner"</span><span class="p">,</span>
<span class="p">)</span></code></pre></div>

<p>BUILD files are Python-like scripts. BUILD files cannot contain arbitrary
Python, but each build rule looks like a Python function call and you can use
"#" to start a single-line comment.</p>

<p><code>java_binary</code> is the type of thing this rule will build.
<code>name</code> is how you'll refer to the rule when you run "bazel build"
(in the "examples/java:hello-world" build above the <code>name</code> was
"hello-world"). <code>srcs</code> lists the Java source files Bazel should
compile into a Java binary.  <code>glob(["**/*.java"])</code> is a handy
shorthand for "recursively include every file that ends with .java" (see the
<a href="http://bazel.io/docs/bazel-user-manual.html">user manual</a>
for more information about globbing). Replace <code>com.example.ProjectRunner</code> with
the class that contains the main method.</p>

<p>If you have no actual Java project you're using, you can use the following
commands to make a fake project for this example:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span><span class="c"># If you're not already there, move to your build root directory.</span>
<span class="nv">$ </span><span class="nb">cd</span> ~/gitroot/base_workspace
<span class="nv">$ </span>mkdir -p my-project/java/com/example
<span class="nv">$ </span>cat &gt; my-project/java/com/example/ProjectRunner.java <span class="s">&lt;&lt;EOF</span>
<span class="s">package com.example;</span>

<span class="s">public class ProjectRunner {</span>
<span class="s">    public static void main(String args[]) {</span>
<span class="s">        Greeting.sayHi();</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">EOF</span>
<span class="nv">$ </span>cat &gt; my-project/java/com/example/Greeting.java <span class="s">&lt;&lt;EOF</span>
<span class="s">package com.example;</span>

<span class="s">public class Greeting {</span>
<span class="s">    public static void sayHi() {</span>
<span class="s">        System.out.println("Hi!");</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">EOF</span></code></pre></div>

<p>Now build your project:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>bazel fetch my-project:my-runner
<span class="nv">$ </span>bazel build my-project:my-runner
INFO: Found <span class="m">1</span> target...
Target //my-project:my-runner up-to-date:
  bazel-bin/my-project/my-runner.jar
  bazel-bin/my-project/my-runner
INFO: Elapsed <span class="nb">time</span>: 1.021s, Critical Path: 0.83s
<span class="nv">$ </span>bazel-bin/my-project/my-runner
Hi!</code></pre></div>

<p>Congratulations, you've created your first Bazel BUILD file!</p>

<h2>Adding Dependencies</h2>

<p>Creating one rule to build your entire project may be sufficient for small
projects, but as projects get larger it's important to break up the build into
self-contained libraries that can be assembled into a final product.  This way
the entire world doesn't need to be rebuilt on small changes and Bazel can
parallelize more of the build steps.</p>

<p>To break up a project, create separate rules for each subcomponent and then
make them depend on each other. For the example above, add the following rules
to the <code>my-project/BUILD</code> file:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">java_binary</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"my-other-runner"</span><span class="p">,</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span><span class="s">"java/com/example/ProjectRunner.java"</span><span class="p">],</span>
    <span class="n">main_class</span> <span class="o">=</span> <span class="s">"com.example.ProjectRunner"</span><span class="p">,</span>
    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span><span class="s">":greeter"</span><span class="p">],</span>
<span class="p">)</span>

<span class="n">java_library</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"greeter"</span><span class="p">,</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span><span class="s">"java/com/example/Greeting.java"</span><span class="p">],</span>
<span class="p">)</span></code></pre></div>

<p>Now you can build and run <code>my-project:my-other-runner</code>:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>bazel run my-project:my-other-runner
INFO: Found <span class="m">1</span> target...
Target //my-project:my-other-runner up-to-date:
  bazel-bin/my-project/my-other-runner.jar
  bazel-bin/my-project/my-other-runner
INFO: Elapsed <span class="nb">time</span>: 2.454s, Critical Path: 1.58s

INFO: Running <span class="nb">command </span>line: bazel-bin/my-project/my-other-runner
Hi!</code></pre></div>

<p>If you edit <em>ProjectRunner.java</em> and rebuild <code>my-other-runner</code>, only
<code>ProjectRunner.java</code> needs to be rebuilt (<code>greeter</code> is unchanged).</p>

<h2>Using Multiple Packages</h2>

<p>For larger projects, you will often be dealing with several directories. You
can refer to targets defined in other BUILD files using the syntax
<code>//package-name:target-name</code>.  For example, suppose
<code>my-project/java/com/example/</code> has a <code>cmdline/</code> subdirectory with the following
file:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>mkdir my-project/java/com/example/cmdline
<span class="nv">$ </span>cat &gt; my-project/java/com/example/cmdline/Runner.java <span class="s">&lt;&lt;EOF</span>
<span class="s">package com.example.cmdline;</span>

<span class="s">import com.example.Greeting;</span>

<span class="s">public class Runner {</span>
<span class="s">    public static void main(String args[]) {</span>
<span class="s">        Greeting.sayHi();</span>
<span class="s">    }</span>
<span class="s">}</span>
<span class="s">EOF</span></code></pre></div>

<p>We could add a <code>BUILD</code> file at <code>my-project/java/com/example/cmdline/BUILD</code>
that contained the following rule:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="c"># ~/gitroot/base_workspace/my-project/java/com/example/cmdline/BUILD</span>
<span class="n">java_binary</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"runner"</span><span class="p">,</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span><span class="s">"Runner.java"</span><span class="p">],</span>
    <span class="n">main_class</span> <span class="o">=</span> <span class="s">"com.example.cmdline.Runner"</span><span class="p">,</span>
    <span class="n">deps</span> <span class="o">=</span> <span class="p">[</span><span class="s">"//my-project:greeter"</span><span class="p">]</span>
<span class="p">)</span></code></pre></div>

<p>However, by default, build rules are <em>private</em>. This means that they can only be
referred to by rules in the same BUILD file. This prevents libraries that are
implementation details from leaking into public APIs, but it also means that you
must explicitly allow <code>runner</code> to depend on <code>my-project:greeter</code>. As is, if we
build <code>runner</code> we'll get a permissions error:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>bazel build my-project/java/com/example/cmdline:runner
ERROR: /usr/local/google/home/kchodorow/gitroot/base_workspace/my-project/java/com/example/cmdline/BUILD:2:1:
  Target <span class="s1">'//my-project:greeter'</span> is not visible from target <span class="s1">'//my-project/java/com/example/cmdline:runner'</span>.
  Check the visibility declaration of the former target <span class="k">if</span> you think the dependency is legitimate.
ERROR: Analysis of target <span class="s1">'//my-project/java/com/example/cmdline:runner'</span> failed<span class="p">;</span> build aborted.
INFO: Elapsed <span class="nb">time</span>: 0.091s</code></pre></div>

<p>You can make a rule visibile to rules in other BUILD files by adding a
<code>visibility = level</code> attribute.  Change the <code>greeter</code> rule in
<em>my-project/BUILD</em> to be visible to our new rule:</p>

<div class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">java_library</span><span class="p">(</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s">"greeter"</span><span class="p">,</span>
    <span class="n">srcs</span> <span class="o">=</span> <span class="p">[</span><span class="s">"java/com/example/Greeting.java"</span><span class="p">],</span>
    <span class="n">visibility</span> <span class="o">=</span> <span class="p">[</span><span class="s">"//my-project/java/com/example/cmdline:__pkg__"</span><span class="p">],</span>
<span class="p">)</span></code></pre></div>

<p>This makes <code>//my-project:greeter</code> visible to any rule in the
<code>//my-project/java/com/example/cmdline</code> package. Now we can build and
run the binary:</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>bazel run my-project/java/com/example/cmdline:runner
INFO: Found <span class="m">1</span> target...
Target //my-project/java/com/example/cmdline:runner up-to-date:
  bazel-bin/my-project/java/com/example/cmdline/runner.jar
  bazel-bin/my-project/java/com/example/cmdline/runner
INFO: Elapsed <span class="nb">time</span>: 1.576s, Critical Path: 0.81s

INFO: Running <span class="nb">command </span>line: bazel-bin/my-project/java/com/example/cmdline/runner
Hi!</code></pre></div>

<p>See the <a href="http://bazel.io/docs/build-encyclopedia.html">build encyclopedia</a> for more visibility options.</p>

<h2>Deploying</h2>

<p>If you look at the contents of
<em>bazel-bin/my-project/java/com/example/cmdline/runner.jar</em>, you can see that it
only contains <code>Runner.class</code>, not its dependencies (<code>Greeting.class</code>):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>jar tf bazel-bin/my-project/java/com/example/cmdline/runner.jar
META-INF/
META-INF/MANIFEST.MF
com/
com/example/
com/example/cmdline/
com/example/cmdline/Runner.class</code></pre></div>

<p>To deploy a <code>runner</code> binary, we need a self-contained jar. To build this, build
runner<em>deploy.jar (or, more generally, _&lt;target-name&gt;</em>deploy.jar_):</p>

<div class="highlight"><pre><code class="language-bash" data-lang="bash"><span class="nv">$ </span>bazel build my-project/java/com/example/cmdline:runner_deploy.jar
INFO: Found <span class="m">1</span> target...
Target //my-project/java/com/example/cmdline:runner_deploy.jar up-to-date:
  bazel-bin/my-project/java/com/example/cmdline/runner_deploy.jar
INFO: Elapsed <span class="nb">time</span>: 1.700s, Critical Path: 0.23s</code></pre></div>

<p><code>runner_deploy.jar</code> will contain all of its dependencies.</p>

<h2>Next Steps</h2>

<p>You can now create your own targets and compose them.  See the <a href="http://bazel.io/docs/build-encyclopedia.html">build
encyclopedia</a>
and Bazel
<a href="http://bazel.io/docs/bazel-user-manual.html">user manual</a>
for more information.
<a href="https://groups.google.com/forum/#%21forum/bazel-discuss">Let us know</a>
if you have any questions!</p>

        </div>
      </div>
    </div>

        <footer class="footer">
      <div class="container">
        <div class="row">
          <div class="col-lg-12">
            <p class="text-muted">© 2015 Google</p>
          </div>
        </div>
      </div>
    </footer>

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="Bazel_files/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="Bazel_files/bootstrap.js"></script>

    <!-- Google Analytics tracking code -->
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-61082125-1', 'auto');
      ga('send', 'pageview');
    </script>

  

</body></html>